(this.webpackJsonpdocs=this.webpackJsonpdocs||[]).push([[0],{16:function(t,e,n){},18:function(t,e,n){"use strict";n.r(e);var i,c=n(1),o=n.n(c),r=n(10),u=n.n(r),l=(n(16),n(4)),s=n(9),a=n(3),h=Object(c.createContext)(null),b=n(7),j=n(11),d=function(){function t(e){Object(b.a)(this,t),this.ctx=void 0,this.objects=void 0,this.ctx=e,this.objects=[]}return Object(j.a)(t,[{key:"addObject",value:function(t){var e=this.objects.findIndex((function(e){return e.id===t.id}));-1===e?this.objects.push(t):this.objects[e]=t,this.draw()}},{key:"onEvent",value:function(t){var e=this;return function(n){for(var i=n.nativeEvent,c=i.offsetX,o=i.offsetY,r=0;r<e.objects.length;r++){var u=e.objects[r],l=u.events[t];if(u.path&&l){var s=e.ctx.isPointInPath(u.path,c,o),a=e.ctx.isPointInStroke(u.path,c,o);(s||a)&&l({id:u.id,type:u.type,eventType:t,event:n})}}}}},{key:"draw",value:function(){this.clear();for(var t=0;t<this.objects.length;t++){var e=this.objects[t];this.resetStyle(),e.draw(this.ctx)}}},{key:"resetStyle",value:function(){this.ctx.strokeStyle="#000",this.ctx.fillStyle="#000",this.ctx.lineCap="butt",this.ctx.lineDashOffset=0,this.ctx.lineJoin="miter",this.ctx.lineWidth=1,this.ctx.miterLimit=10}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}}]),t}(),f=n(0),v=function(t){var e=t.children,n=Object(c.useRef)(null),i=Object(c.useState)(null),o=Object(a.a)(i,2),r=o[0],u=o[1],l=Object(c.useMemo)((function(){return null!==r?new d(r):null}),[r]);return Object(c.useEffect)((function(){if(n.current){var t=n.current.getContext("2d");if(t){var e=n.current.getBoundingClientRect();n.current.width=e.width,n.current.height=e.height,u(t)}}}),[]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("canvas",{ref:n,style:{width:"100%",height:"100%"},onClick:null===l||void 0===l?void 0:l.onEvent("onClick"),onContextMenu:null===l||void 0===l?void 0:l.onEvent("onContextMenu"),onDoubleClick:null===l||void 0===l?void 0:l.onEvent("onDoubleClick"),onMouseDown:null===l||void 0===l?void 0:l.onEvent("onMouseDown"),onMouseMove:null===l||void 0===l?void 0:l.onEvent("onMouseMove"),onMouseUp:null===l||void 0===l?void 0:l.onEvent("onMouseUp"),onPointerDown:null===l||void 0===l?void 0:l.onEvent("onPointerDown"),children:"\u0418\u0437\u0432\u0438\u043d\u0438\u0442\u0435, \u0432\u0430\u0448 \u0431\u0440\u0430\u0443\u0437\u0435\u0440 \u043d\u0435\u0442 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442<canvas> \u044d\u043b\u0435\u043c\u0435\u043d\u0442."}),r?Object(f.jsx)(h.Provider,{value:l,children:e}):null]})},O=n(2);!function(t){t.TEXT="TEXT",t.ARC="ARC",t.RECT="RECT",t.LINE="LINE"}(i||(i={}));var x=function t(e,n,i,c,o,r){Object(b.a)(this,t),this.id=void 0,this.type=void 0,this.draw=void 0,this.path=void 0,this.events=void 0,this.params=void 0,this.id=e,this.type=n,this.draw=i,this.path=c,this.events=o,this.params=r};function g(t){var e={};for(var n in t)"on"===n.slice(0,2)&&(e[n]=t[n]);return e}function y(t,e,n,i){i&&(t.fillStyle=i,t.fill(e)),n&&(t.strokeStyle=n,t.stroke(e))}var p=function(t){var e=t.x,n=t.y,o=t.width,r=t.height,u=t.stroke,l=t.fill,s=Object(c.useContext)(h),a=Object(c.useRef)(Object(O.a)()),b=g(t);return Object(c.useEffect)((function(){var t=new Path2D,c={x:e,y:n,width:o,height:r,stroke:u,fill:l},h=new x(a.current,i.RECT,(function(i){t.rect(e,n,o,r),y(i,t,u,l)}),t,b,c);null===s||void 0===s||s.addObject(h)}),[b,l,r,s,u,o,e,n]),null},m=function(t){var e=t.label,n=t.type,i=t.value,c=t.onChange;return Object(f.jsxs)("label",{children:[Object(f.jsx)("span",{children:e}),Object(f.jsx)("input",{type:n,value:i,onChange:function(t){return c(t.target.value)}})]})},C={x:0,y:0,width:100,height:100,stroke:"",fill:"#004cff"};function w(t,e){switch(e.type){case"setParams":return Object(l.a)(Object(l.a)({},t),e.payload);default:throw new Error}}var k=function(t){var e=t.onAddRect,n=t.onHide,i=Object(c.useReducer)(w,C),o=Object(a.a)(i,2),r=o[0],u=o[1],s=function(t){return u({type:"setParams",payload:Object(l.a)(Object(l.a)({},r),t)})};return Object(f.jsx)("div",{className:"create-rect",onClick:n,children:Object(f.jsxs)("div",{className:"create-rect-modal",onClick:function(t){return t.stopPropagation()},children:[Object(f.jsx)("h6",{children:"Set Rect Params"}),Object(f.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e(r),n()},children:[Object(f.jsx)(m,{label:"x",type:"number",value:String(r.x),onChange:function(t){return s({x:Number(t)})}}),Object(f.jsx)(m,{label:"y",type:"number",value:String(r.y),onChange:function(t){return s({y:Number(t)})}}),Object(f.jsx)(m,{label:"width",type:"number",value:String(r.width),onChange:function(t){return s({width:Number(t)})}}),Object(f.jsx)(m,{label:"height",type:"number",value:String(r.height),onChange:function(t){return s({height:Number(t)})}}),Object(f.jsx)(m,{label:"stroke",type:"color",value:String(r.stroke),onChange:function(t){return s({stroke:t})}}),Object(f.jsx)(m,{label:"fill",type:"color",value:String(r.fill),onChange:function(t){return s({fill:t})}}),Object(f.jsx)("button",{type:"submit",children:"Add Rect"})]})]})})},S=function(t){var e=t.object,n=t.onModifyObject;return Object(f.jsxs)("div",{className:"controls",children:[Object(f.jsx)("h5",{children:"Controls"}),Object(f.jsxs)("form",{className:"controls-form",children:[Object(f.jsx)(m,{label:"x",type:"number",value:String(e.x),onChange:function(t){return n({x:Number(t)})}}),Object(f.jsx)(m,{label:"y",type:"number",value:String(e.y),onChange:function(t){return n({y:Number(t)})}}),Object(f.jsx)(m,{label:"width",type:"number",value:String(e.width),onChange:function(t){return n({width:Number(t)})}}),Object(f.jsx)(m,{label:"height",type:"number",value:String(e.height),onChange:function(t){return n({height:Number(t)})}}),Object(f.jsx)(m,{label:"stroke",type:"color",value:e.stroke,onChange:function(t){return n({stroke:t})}}),Object(f.jsx)(m,{label:"fill",type:"color",value:e.fill,onChange:function(t){return n({fill:t})}})]})]})},E=function(){var t=Object(c.useState)([]),e=Object(a.a)(t,2),n=e[0],i=e[1],o=Object(c.useState)(),r=Object(a.a)(o,2),u=r[0],h=r[1],b=Object(c.useState)(!1),j=Object(a.a)(b,2),d=j[0],O=j[1];return Object(c.useEffect)((function(){d&&h(void 0)}),[d]),Object(f.jsxs)("div",{className:"app",children:[Object(f.jsx)("h1",{children:"React-Canva"}),Object(f.jsx)("button",{onClick:function(){return O(!0)},children:"Add Rect"}),d&&Object(f.jsx)(k,{onAddRect:function(t){i([].concat(Object(s.a)(n),[t]))},onHide:function(){return O(!1)}}),void 0!==u&&Object(f.jsx)(S,{object:n[u],onModifyObject:function(t){if(void 0!==u){var e=Object(s.a)(n),c=e[u];e[u]=Object(l.a)(Object(l.a)({},c),t),i(e)}}}),Object(f.jsx)("div",{className:"canvas",children:Object(f.jsx)(v,{children:n.map((function(t,e){return Object(f.jsx)(p,{x:t.x,y:t.y,width:t.width,height:t.height,onClick:function(t){return function(t,e){h(t),console.log(e)}(e,t)},fill:t.fill,stroke:u===e?"#ff0015":""})}))})})]})},N=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,19)).then((function(e){var n=e.getCLS,i=e.getFID,c=e.getFCP,o=e.getLCP,r=e.getTTFB;n(t),i(t),c(t),o(t),r(t)}))};u.a.render(Object(f.jsx)(o.a.StrictMode,{children:Object(f.jsx)(E,{})}),document.getElementById("root")),N()}},[[18,1,2]]]);
//# sourceMappingURL=main.05bd806e.chunk.js.map